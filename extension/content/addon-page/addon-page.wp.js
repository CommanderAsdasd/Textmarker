!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=54)}({0:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._ERRORTRACKER=t._L10N=t._PORT=t._DOMMODULE=t._MODULE=t._EXTEND=t._GET_ACTIVE_TAB=t._COPY=void 0;var r=n(6),o=n(11),i=d(n(5)),s=n(1),a=n(10),c=n(3),u=d(n(9)),l=d(n(2));function d(e){return e&&e.__esModule?e:{default:e}}t._COPY=r._COPY,t._GET_ACTIVE_TAB=o._GET_ACTIVE_TAB,t._EXTEND=i.default,t._MODULE=s._MODULE,t._DOMMODULE=a._DOMMODULE,t._PORT=c._PORT,t._L10N=u.default,t._ERRORTRACKER=l.default},1:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._MODULE=void 0;var r,o=n(4),i=(r=o)&&r.__esModule?r:{default:r};t._MODULE=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));for(i in e)n[i]=e[i];var r=n.events,o=void 0,i=void 0,s=void 0,a=void 0;if(r&&(o=r.ENV))for(s in o)n[a=o[s]]&&n.on(s,n.proxy(n,n[a]));return!n.autoinit||n.autoinit(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.default),t}()},10:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._DOMMODULE=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1);t._DOMMODULE=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e._bound={},e._extraBound=[];var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.addListenersManually||n.addListeners(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o._MODULE),r(t,[{key:"generalHandler",value:function(e,t,n){var r=n.target,o=void 0,i=void 0,s=void 0,a=void 0,c=void 0,u=void 0,l=void 0;for(o in e)if(i=o,u="."===(a=o[0]),l="*"===a,((c="#"===a)||u)&&(o=o.substr(1)),l||u&&r.classList.contains(o)||c&&r.id===o||r.nodeName.toLowerCase()===o){"function"==typeof(s=e[i])?s(n,r):this[s]&&this[s](n,r);break}}},{key:"addListener",value:function(e,t,n){n=n||this.el;var r="function"==typeof t?t:this[t];n.addEventListener(e,r,!1),n===this.el?(this._bound[e]||(this._bound[e]=[]),this._bound[e].push(r)):this._extraBound.push([n,e,r])}},{key:"addListeners",value:function(){var e=this.events,t=void 0,n=void 0,r=void 0,o=void 0,i=void 0;if(!e||!(t=e.DOM)||!(n=this.el))return!1;for(o in t)r=t[o],i=this.proxy(this,this.generalHandler,r,o),n.addEventListener(o,i,!1),this._bound[o]||(this._bound[o]=[]),this._bound[o].push(i)}},{key:"removeListeners",value:function(){var e=void 0,t=void 0,n=void 0;for(e in this._bound)for(n=(t=this._bound[e]).length;n--;)this.el.removeEventListener(e,t[n],!1),t.splice(n,1);var r=this._extraBound,o=0,i=void 0;for(n=r.length;o<n;o++)(i=r[o])[0].removeEventListener(i[1],i[2],!1)}}]),t}()},11:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t._GET_ACTIVE_TAB=function(){return browser.tabs.query({currentWindow:!0,active:!0}).then(function(e){return e[0]})}},111:function(e,t){},12:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=new r._MODULE({events:{ENV:{"toggled:sync":"setAreas"}},initialized:!1,area_settings:"sync",area_history:"sync",setAreas:function(){var e=this;return browser.storage.sync.get().then(function(t){t&&t.sync&&(e.area_settings=t.sync.settings?"sync":"local",e.area_history=t.sync.history?"sync":"local")})},get:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"storage";if(!this["_get_"+t])throw"field "+t+" doesn't exist";return this.initialized?this["_get_"+t]():(this.initialized=!0,this.setAreas().then(function(){return e["_get_"+t]()}))},_get_storage:function(){var e=this;return browser.storage.local.get().then(function(t){return browser.storage.sync.get().then(function(n){return["version","logs"].forEach(function(e){t[e]=t[e]||n[e]}),"sync"===e.area_settings&&(t.settings=n.settings),e._get_history().then(function(e){return t.history=e,t})})})},_get_local_storage:function(){return browser.storage.local.get()},_get_synced_storage:function(){return browser.storage.sync.get()},_get_history:function(){return browser.storage.sync.get().then(function(e){var t=e.history;return browser.storage.local.get().then(function(e){var n=e.history;if(!t)return n;if(!n)return t;for(var r in t.order=t.order.concat(n.order),n.entries)t.entries[r]=n.entries[r];return t})})},_get_settings:function(){return browser.storage[this.area_settings].get().then(function(e){return e.settings})},_get_logs:function(){return browser.storage.local.get().then(function(e){return e&&e.logs?e.logs:[]})},_get_download_option:function(){return browser.storage[this.area_settings].get().then(function(e){return e&&e.settings?e.settings.history.download:"text"})},_get_markers:function(){return browser.storage[this.area_settings].get().then(function(e){return e.settings.markers})},_get_shortcuts:function(){return browser.storage[this.area_settings].get().then(function(e){return e.settings.shortcuts})}})},14:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=t,this.init()}return r(e,[{key:"init",value:function(){this.el.addEventListener("click",this.toggle,!1)}},{key:"toggle",value:function(e){e.stopPropagation();var t=this.getAttribute("data-target"),n=t?t.split(" "):null,r=this.getAttribute("data-toggle"),o=r?r.split(" "):null;o?o.forEach(function(e,t){return document.getElementById(n[t]).classList[e]("open")}):target.disabled=!this.checked}}]),e}();t.default=o},15:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={note_pbm:1,note_restoration_failure:2,note_url:3,error_save_style:4,error_save__toggle_sc:5,error_save_change_sc:6,error_save_ctm:7,error_save_autosave:8,error_save_naming:9,error_save_notify:10,error_save_download:11,error_save_bmicon:12,error_clean_history:13,error_add_marker:14,error_remove_marker:15,error_save_entry:16,error_update_entry:17,error_del_entry:18,error_empty_synced_storage_onstart:19,error_empty_synced_storage_onupdate:20,error_empty_local_storage_onstart:21,error_import_empty:22,error_import_history:23,error_import_settings:24,error_import_outdated:25,error_import_history_not_found:26,error_import_settings_not_found:27,error_naming:28,error_storage_migration:29,error_empty_local_storage_onupdate:30,error_toggle_sync:31,error_save_priv:32,getKeyByValue:function(e){for(var t in this)if(this[t]==e)return t;return""}}},18:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return new r._DOMMODULE({el:e,events:{DOM:{click:{li:"toggle"}}},pageNav:null,current:null,autoinit:function(){this.pageNav=e.hasAttribute("data-page-nav");var t=this.current=e.getElementsByClassName("active")[0];this.open(t)},toggle:function(e,t){if(t.classList.contains("disabled")||this.current==t)return!1;this.current&&this.close(this.current),this.open(t)},open:function(e){var t=e.getAttribute("data-target");e.classList.add("active"),document.getElementById(t).classList.remove("none"),this.emit("opened:tab",t),this.current=e,this.pageNav&&(window.document.title="Textmarker - "+browser.i18n.getMessage(t))},close:function(e){e.classList.remove("active"),document.getElementById(e.getAttribute("data-target")).classList.add("none")}})};var r=n(0)},2:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new(n(1)._MODULE)({autoinit:function(){var e=this;window.addEventListener("error",function(t){var n=t.filename.split("/").pop();["sidebar.wp.js","tbb-menu.wp.js","options.wp.js","addon-page.wp.js"].includes(n)&&e.emit("error:browser-console",{message:t.message,location:t.filename.split("/").pop().split(".").shift()+":"+t.lineno+":"+t.colno,time:(new Date).getTime()})},!1)}});t.default=r},3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._PORT=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1);t._PORT=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.port=null;var r=n.type;browser.runtime.onMessage.addListener(n.proxy(n,n.passMessage)),"privileged"!==r&&"background"!==r||n.initPorting();var o=n.events,i=void 0,s=void 0;if(o){if(i=o.ONEOFF){var a=!0,c=!1,u=void 0;try{for(var l,d=i[Symbol.iterator]();!(a=(l=d.next()).done);a=!0){var g=l.value;n.on(g,n.proxy(n,n.sendMessage,g))}}catch(e){c=!0,u=e}finally{try{!a&&d.return&&d.return()}finally{if(c)throw u}}}if(s=o.CONNECTION){var h=!0,f=!1,m=void 0;try{for(var p,y=s[Symbol.iterator]();!(h=(p=y.next()).done);h=!0){var v=p.value;n.on(v,n.proxy(n,n.postMessage,v))}}catch(e){f=!0,m=e}finally{try{!h&&y.return&&y.return()}finally{if(f)throw m}}}}return n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o._MODULE),r(t,[{key:"passMessage",value:function(e,t,n){e.args=e.args||[];var r=[].concat(e.ev,e.args);return t&&t.name||(r=r.concat(t,n)),this.emit.apply(this,r),!!e.wait}},{key:"sendMessage",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=this.type,i={ev:e,args:n};if("content"===o)browser.runtime.sendMessage(i).catch(function(){});else if("background"===o){var s=n[n.length-1];void 0!==s&&s.tab?browser.tabs.sendMessage(s.tab,i).catch(function(){}):browser.tabs.query({}).then(function(e){var t=!0,n=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(t=(o=s.next()).done);t=!0){var a=o.value;browser.tabs.sendMessage(a.id,i).catch(function(){})}}catch(e){n=!0,r=e}finally{try{!t&&s.return&&s.return()}finally{if(n)throw r}}})}}},{key:"postMessage",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o={ev:e,args:n};this.port&&this.port.postMessage(o)}},{key:"initPorting",value:function(){this.postponeConnection?this.addConnectionListeners(this.proxy(this,this.connect)):(this.connect(),this.addConnectionListeners())}},{key:"connect",value:function(){var e=this;(this.port=this.port||browser.runtime.connect({name:this.name})).onDisconnect.addListener(function(){return e.port=null})}},{key:"addConnectionListeners",value:function(e){var t=this;browser.runtime.onConnect.addListener(function(n){n.onMessage.addListener(t.proxy(t,t.passMessage)),!e||e()})}}]),t}()},4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o={},i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"on",value:function(e,t){o[e]||(o[e]=[]),o[e].push(t)}},{key:"emit",value:function(e){for(var t=this,n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var s=0,a=(e=e.split(" ")).length,c=void 0;s<a;s++)(c=o[e[s]])&&c.forEach(function(e){return e.apply(t,r)})}},{key:"request",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return browser.runtime.sendMessage({ev:e,args:n,wait:!0}).catch(function(){})}},{key:"proxy",value:function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return function(){for(var n=arguments.length,o=Array(n),i=0;i<n;i++)o[i]=arguments[i];return t.apply(e,r.concat(o))}}}]),e}();t.default=i},43:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return new r._DOMMODULE({el:document.getElementById("paginator"),events:{ENV:{"saved:entry":"add","deleted:entries":"updateFromStorage","filtered:history":"reset","imported:history":"updateFromStorage","changed:per-page-count":"changeCountPerPage"},DOM:{click:{".page":"goto",".prev":"prev",".next":"next"}}},numberPages:1,numberEntries:0,currentPage:1,perPage:10,autoinit:function(){this.updateFromStorage()},goto:function(e,t){var n=1*t.getAttribute("data-page");this.currentPage!==n&&(this.emit("paginate:history",n),this.currentPage=n,this.render())},prev:function(){1!==this.currentPage&&(this.emit("paginate:history",--this.currentPage),this.render())},next:function(){this.currentPage!==this.numberPages&&(this.emit("paginate:history",++this.currentPage),this.render())},add:function(){this.update(++this.numberEntries)},remove:function(){this.update(--this.numberEntries)},updateFromStorage:function(){var e=this;o.default.get("settings").then(function(t){return e.perPage=t.history.pp||10}).then(function(){return o.default.get("history").then(function(t){return e.update(t.order.length)})})},update:function(e,t){this.numberEntries=e,this.numberPages=e?Math.ceil(e/this.perPage):1,this.currentPage>this.numberPages&&(this.currentPage=this.numberPages,t||this.emit("paginate:history",this.currentPage)),this.render()},reset:function(e){this.currentPage=1,this.update(e)},render:function(){var e=document.getElementById("paginator-list"),t=this.numberEntries;if(Array.from(e.getElementsByClassName("page")).forEach(function(e){return e.remove()}),t<this.perPage+1)this.el.classList.add("none");else{this.el.classList.remove("none");var n=this.currentPage,r=this.numberPages,o=7-(r-1-n),i=document.createDocumentFragment(),s=e.getElementsByClassName("next")[0],a=Math.max(2,n-7);o>0&&(a=Math.max(2,Math.min(a,a-o)));var c=Math.min(r,a+14)+1;for(this.appendButton(i,1);a<c;a++)this.appendButton(i,a);r>c-1&&this.appendButton(i,r),e.insertBefore(i,s)}},appendButton:function(e,t){var n=document.createElement("li");n.setAttribute("data-page",t),n.appendChild(document.createTextNode(t)),n.classList.add("page"),t===this.currentPage&&n.classList.add("active"),e.appendChild(n)},changeCountPerPage:function(e){this.perPage=e,this.update(this.numberEntries,!0)}})};var r=n(0),o=i(n(12));i(n(14));function i(e){return e&&e.__esModule?e:{default:e}}},44:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return new o._MODULE({events:{ENV:{"updated:logs":"setLogLink"}},autoinit:function(){this.setAddonLinks().setDeveloperLinks().setLogLink()},setAddonLinks:function(){for(var e=browser.i18n.getMessage("url_moz_addon"),t=document.getElementsByClassName("moz-addon"),n=t.length,r=void 0;n--;)(r=t[n]).href=e,"moz-addon--contact"===r.id&&(r.innerText=e);return this},setDeveloperLinks:function(){for(var e=browser.i18n.getMessage("url_moz_developer"),t=document.getElementsByClassName("moz-developer"),n=t.length,r=void 0;n--;)(r=t[n]).href=e,"moz-developer--contact"===r.id&&(r.innerText=e);return this},setLogLink:function(){var e=document.getElementById("log-mail");s.default.get("logs").then(function(t){for(var n=t?t.length:0,r="mailto:undflybir@gmx.de?subject=Textmarker"+encodeURIComponent(" : Error Logs")+"&body="+encodeURIComponent("- "+browser.i18n.getMessage("your_msg")+" -\n\n\nLOGS:\n\n"),o=void 0;n--;)o=t[n],r+=encodeURIComponent(new Date(o[0]).toUTCString()+" --- "+o[1]+"\n");e.href=r})}})};var r,o=n(0),i=n(12),s=(r=i)&&r.__esModule?r:{default:r}},45:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return new o._DOMMODULE({el:document.getElementById("export"),events:{ENV:{"updated:settings":"updateExportLinks","updated:history":"updateExportLinks","toggled:sync":"updateExportLinks","synced:entry":"updateExportLinks"},DOM:{click:{".import-button":"triggerFileInput"},change:{".import-file":"handleFile"},mousedown:{".export-button":"updateExportName"}}},autoinit:function(){this.updateExportLinks()},import:function(e,t){var n;try{n=JSON.parse(e)}catch(e){return this.displayFailure(browser.i18n.getMessage("error_file_parse"))}n&&(this.emit("import:storage",n,t),this.displayFailure(""))},triggerFileInput:function(e,t){document.getElementById("import--"+t.getAttribute("data-type")).click()},handleFile:function(e,t){var n=new FileReader,r=t.files[0],o=r.size/1e6,i=t.getAttribute("data-type"),s=this;return o>50?this.displayFailure(browser.i18n.getMessage("error_file_size")):"sync"===i&&o>.099?this.displayFailure(browser.i18n.getMessage("error_file_size_sync")):"json"!==r.name.split(".").pop()?this.displayFailure(browser.i18n.getMessage("error_file_format")):(n.onload=function(e){s.import(e.target.result,i)},void n.readAsText(r))},displayFailure:function(e){document.getElementById("import-error").innerText=e},updateExportLinks:function(){var e=document.getElementById("export-local"),t=document.getElementById("export-synced");s.default.get("local_storage").then(function(t){e.href="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t))}).then(function(){return s.default.get("synced_storage").then(function(e){t.href="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e))})})},updateExportName:function(e,t){t.parentNode.setAttribute("download","Textmarker-data-"+t.getAttribute("data-type")+"-"+(new Date).toLocaleString().replace(/\D/g,"_")+".json")}})};var r,o=n(0),i=n(12),s=(r=i)&&r.__esModule?r:{default:r}},46:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return new o._DOMMODULE({el:document.getElementById("sync"),events:{ENV:{"failed:toggle-sync":"undo"},DOM:{click:{".switch":"toggleSwitch"}}},autoinit:function(){document.getElementById("sync-switch-settings").classList.toggle("active","sync"===s.default.area_settings),document.getElementById("sync-switch-history").classList.toggle("active","sync"===s.default.area_history)},toggleSwitch:function(e,t){(t=t.classList.contains("sync-switch")?t:t.parentNode).classList.toggle("active"),this.emit("toggle:sync",t.getAttribute("data-type"),t.classList.contains("active"))},undo:function(e){document.getElementById("sync-switch-"+e).classList.toggle("active")}})};var r,o=n(0),i=n(12),s=(r=i)&&r.__esModule?r:{default:r}},47:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return new r._DOMMODULE({el:document.getElementById("logs"),events:{ENV:{"updated:logs":"log"},DOM:{click:{"#clear-logs":"clear"}}},autoinit:function(){this.log()},log:function(){var e=this;o.default.get("logs").then(function(t){t=t||[];var n=document.getElementById("logs-table"),r=n.getElementsByTagName("tbody")[0],o=document.getElementById("no-logs"),s=document.getElementById("clear-logs"),a=t.length,c=document.createDocumentFragment(),u=void 0,l=void 0,d=void 0,g=void 0,h=void 0,f=void 0,m=void 0,p=void 0;if(a){for(o.classList.add("none"),n.classList.remove("none"),s.classList.remove("none");a--;)"number"==typeof(p=(f=t[a])[1])&&(p=browser.i18n.getMessage(i.default.getKeyByValue(f[1]))),m=e.optimizeDateString(new Date(f[0]).toLocaleString()),u=document.createElement("tr"),l=document.createElement("td"),d=document.createElement("td"),g=document.createTextNode(m),h=document.createTextNode(p),l.appendChild(g),d.appendChild(h),u.appendChild(l),u.appendChild(d),c.appendChild(u);r.innerText="",r.appendChild(c)}else o.classList.remove("none"),n.classList.add("none"),s.classList.add("none")})},clear:function(){this.emit("clear:logs")},optimizeDateString:function(e){return e.replace(/^(\d{1})(\D{1})/,function(e,t,n){return"0"+t+n}).replace(/(\D{1})(\d{1}\D{1})/g,function(e,t,n){return t+"0"+n})}})};var r=n(0),o=s(n(12)),i=s(n(15));function s(e){return e&&e.__esModule?e:{default:e}}},48:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(12),s=(r=i)&&r.__esModule?r:{default:r};var a=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.key=t,this.styles={"background-color":n,color:void 0,"font-size":void 0,"font-family":void 0,"font-weight":void 0,"font-style":void 0,"text-decoration":void 0,"text-shadow":void 0},this.shadow={x:"1px",y:"1px",blur:"1px",color:"#000000"},this.init().then(function(){return r.inject().preview()})}return o(e,[{key:"init",value:function(){var e=this;return s.default.get("markers").then(function(t){var n=t[e.key];n?e.style=n:e.setStyle();for(var r=e.style.split(";"),o=r.length,i=void 0,s=void 0,a=void 0;o--;)(i=r[o])&&(s=i.split(":"),e.styles[s[0]]=s[1]);if((a=e.styles["text-shadow"])&&"none"!==a){var c=a.split(" ");e.shadow.x=c[0],e.shadow.y=c[1],e.shadow.blur=c[2],e.shadow.color=c[3]}})}},{key:"inject",value:function(){var e,t,n=this,r=this.styles,o=r["background-color"],i=document.getElementById("bg-color"),s=document.getElementById("text-color"),a=r.color,c=void 0;return document.getElementById("bg-color-checkbox").checked=!!o,i.value=o||"#ffffff",i.disabled=!o,document.getElementById("text-color-checkbox").checked=!!a,s.value=a||"#000000",s.disabled=!a,["font-size","font-family","font-weight","font-style","text-decoration"].forEach(function(e){document.getElementById(e).value=r[e]||"default"}),c=document.getElementById("text-shadow"),t=(e=r["text-shadow"])?"none"===e?2:1:0,c.selectedIndex=t,c.children[t].click(),["x","y","blur","color"].forEach(function(e){document.getElementById("text-shadow-"+e).value=n.shadow[e].replace("px","")}),this}},{key:"preview",value:function(){return document.getElementById("example").style=this.style,this}},{key:"update",value:function(e){var t=e.classList,n=e.name,r=void 0;if(t.contains("css-color"))if(e.checked){if(r=document.getElementById(e.getAttribute("data-target")).value,!this.isValid(n,r))return!1;this.styles[n]=r}else this.styles[n]=void 0;else if(t.contains("shadow"))if("default"!==(r=e.value)&&this.isValid(n,r)){switch(r){case"none":this.styles["text-shadow"]="none";break;case"default":this.styles["text-shadow"]=void 0;break;case"shadow":this.setShadow();break;default:return!1}}else this.styles[n]="";else t.contains("shadow-value")?(r=e.value,this.isValid(n,r)?(t.contains("shadow-px-value")&&(r+="px"),this.shadow[n]=r,this.setShadow()):this.styles[n]=""):"default"!==(r=e.value)&&this.isValid(n,r)?this.styles[n]=r:this.styles[n]="";return this.setStyle().preview()}},{key:"isValid",value:function(e,t){var n=void 0;switch(e){case"background-color":case"color":n=/^#[0-9A-F]{6}$/i.test(t);break;case"font-size":n=/^[0-9]{1,2}px$/.test(t);break;case"font-family":n=/^[a-z,\s-]{5,40}$/i.test(t);break;case"font-weight":case"font-style":n=/^[a-z]{4,7}$/i.test(t);break;case"text-decoration":n=/^[a-z-]{7,12}$/i.test(t);break;case"text-shadow":n=/^[a-z]{4,7}$/i.test(t);break;case"x":case"y":case"blur":n=/^\d$/;break;default:n=!1}return n}},{key:"setShadow",value:function(){this.styles["text-shadow"]=this.shadow.x+" "+this.shadow.y+" "+this.shadow.blur+" "+this.shadow.color}},{key:"setStyle",value:function(){var e="",t=void 0;for(var n in this.styles)(t=this.styles[n])&&(e+=n+":"+t+";");return this.style=e,this}}]),e}();t.default=a},49:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return new r._DOMMODULE({el:document.getElementById("settings"),events:{ENV:{"imported:settings":"update","updated:bg-color-settings":"update","updated:saveopt-settings":"update","updated:custom-search-settings":"showCustomSearchSettingSuccess","toggled:sync-settings":"update"},DOM:{change:{".css":"changeStyle","#customized-key":"updateMarker","#add-key":"addMarker","#remove-key":"removeMarker",".sc-cb":"toggleShortcut",".shortcut-select":"changeShortcut",".save-opt":"changeSaveOpt",".naming-opt":"changeNamingOpt","#notes-new":"toggleSaveNoteOpt",".customize-quickbuttons":"changeQuickbuttonOpt",".ctm-cb":"toggleCtm",".notes-cb":"toggleNotes",".misc-cb":"toggleMisc",".tmuipos":"changeTmuiPositionOpt","#private-save":"togglePrivSave"},click:{"#custom-search":"changeCustomSearch",".custom-search-input":"hideCustomSearchSettingSuccess"}}},allowedKeys:"a b c d e f g h i j k l n o p q r s t u v x y z 0 1 4 5 6 7 8 9 enter - +".split(" "),allowedShortcuts:["","ctrlKey","shiftKey","altKey","ctrlKey-shiftKey","ctrlKey-altKey","shiftKey-altKey","metaKey","metaKey-shiftKey","metaKey-altKey"],allowedQuickbuttonOpts:["title","url","text","text +meta","text +notes","text +lost","text m","text 2","text 3","text c","text lost"],markerKeys:["m","2","3"],customMarkerKeys:[],marker:null,customSearch:browser.i18n.getMessage("lng")+".wikipedia.org/wiki/",autoinit:function(){this.init()},init:function(){var e=this;o.default.get("settings").then(function(t){var n=t.markers,r=e.markerKeys,o=e.customMarkerKeys,i=void 0,s=void 0;for(s in n)i=s.toLowerCase(),r.includes(i)||o.includes(i)||e.customMarkerKeys.push(i);e.renderMarkerSelectOptions().updateMarker("m").injectSettings(t)})},resume:function(){return Array.prototype.slice.call(document.getElementsByClassName("custom-key")).forEach(function(e){return e.remove()}),Array.prototype.slice.call(document.getElementsByClassName("custom-marker-option")).forEach(function(e){return e.remove()}),this.customMarkerKeys=[],this},update:function(){this.resume().init()},updateMarker:function(e,t,n){var r=t?t.value:e||(this.marker?this.marker.key:"m");return this.marker=new i.default(r,n),this},renderMarkerSelectOptions:function(){for(var e=document.getElementById("customized-key"),t=document.getElementById("custom-keys"),n=document.getElementById("add-key"),r=document.getElementById("remove-key"),o=this.allowedKeys,i=this.customMarkerKeys,s=o.length,a=i.length,c=0,u=document.createDocumentFragment(),l=document.createDocumentFragment(),d=document.createDocumentFragment(),g=document.createDocumentFragment(),h=void 0,f=void 0,m=void 0,p=void 0;c<a;c++)p="ENTER"===(p=(m=i[c]).toUpperCase())?String.fromCharCode(8629):p,h=document.createElement("option"),u.appendChild(h),h.value=m,h.innerText=m.toUpperCase(),h.className="custom-marker-option custom-marker-option-"+m,d.appendChild(h.cloneNode(!0)),f=document.createElement("div"),l.appendChild(f),f.className="key custom-key",f.id="custom-key-"+m,f.innerText=p;for(e.appendChild(u),t.appendChild(l),r.appendChild(d),c=0;c<s;c++)m=o[c].toLowerCase(),i.includes(m)||(p=m.toUpperCase(),h=document.createElement("option"),g.appendChild(h),h.value=m,h.innerText=p,h.className="custom-marker-option custom-marker-option-"+m);return n.appendChild(g),this},injectSettings:function(e){var t=e.shortcuts,n=void 0,r=void 0,o=void 0,i=void 0,s=void 0;for(n in t)s=t[n],r=document.getElementById("sc-"+n),o=document.getElementById("shortcut-select-"+n),i=document.getElementById("cm-"+n),r&&(r.checked=s[1]),o&&(o.value=s[0]),i&&(i.checked=s[2]);var a=e.history,c=document.getElementsByName("save-opt");a.autosave?c[0].checked=!0:c[1].checked=!0,document.getElementById("name-"+a.naming).checked=!0,document.getElementById("private-save").checked=a.saveInPriv,document.getElementById("notes-new").checked=a.saveNote,document.getElementById("quickbutton-download-select").value=a.download;var u=e.misc;document.getElementById("misc-bm").checked=u.bmicon,document.getElementById("misc-noteicon").checked=u.noteicon,document.getElementById("misc-noteonclick").checked=u.noteonclick,document.getElementById("notes-restoration-failure").checked=u.failureNote,document.getElementById("notes-restoration-success").checked=u.successNote,document.getElementById("notes-pbm").checked=u.pbmNote,document.getElementById("notes-changed").checked=u.changedNote,document.getElementById("notes-error").checked=u.errorNote,document.getElementById("custom-search--start").value=u.customSearch?u.customSearch[0]:this.customSearch,document.getElementById("custom-search--end").value=u.customSearch?u.customSearch[1]:"",document.getElementById("tmuipos--noteicon").value=u.tmuipos,document.getElementById("tmuipos--bmicon").value=u.tmuipos},showCustomSearchSettingSuccess:function(){document.getElementById("custom-search--submitted").classList.remove("none")},hideCustomSearchSettingSuccess:function(){document.getElementById("custom-search--submitted").classList.add("none")},changeStyle:function(e,t){var n=this.marker.update(t);this.emit("change:style-setting",n.key,n.style)},addMarker:function(e,t){var n=t.value,r=document.getElementById("customized-key"),o=document.getElementById("custom-keys"),i=document.getElementById("remove-key"),s=t.children[t.selectedIndex],a=s.cloneNode(!0),c=document.createElement("div"),u=this.getRandomLightColor();if(!n||i.children.length>=12||-1===this.allowedKeys.indexOf(n))return!1;i.appendChild(s),i.selectedIndex=0,r.appendChild(a),a.selected=!0,c.className="key custom-key",c.id="custom-key-"+n,o.appendChild(c),c.innerText="enter"===n?String.fromCharCode(8629):n.toUpperCase(),this.updateMarker(n,null,u),this.emit("add:custom-marker",n,"background-color:"+u+";")},removeMarker:function(e,t){var n,r=t.value,o=document.getElementById("customized-key"),i=(document.getElementById("custom-keys"),document.getElementById("add-key"));if(!r||-1===this.allowedKeys.indexOf(r))return!1;n=t.children[t.selectedIndex],i.appendChild(n),i.selectedIndex=0,t.selectedIndex=0,o.getElementsByClassName("custom-marker-option-"+r)[0].remove(),document.getElementById("custom-key-"+r).remove(),o.selectedIndex=0,this.updateMarker("m"),this.emit("remove:custom-marker",r)},toggleShortcut:function(e,t){this.emit("toggle:shortcut-setting",t.name,t.checked)},changeShortcut:function(e,t){if(!this.allowedShortcuts.includes(t.value))return!1;this.emit("change:shortcut-setting",t.name,t.value)},toggleCtm:function(e,t){this.emit("toggle:ctm-setting",t.name,t.checked)},changeSaveOpt:function(e,t){this.emit("change:saveopt-setting",!!t.getAttribute("data-id"))},togglePrivSave:function(e,t){this.emit("toggle:priv-setting",t.checked)},changeNamingOpt:function(e,t){this.emit("change:namingopt-setting",t.getAttribute("data-id"))},toggleSaveNoteOpt:function(e,t){this.emit("toggle:noteopt-setting",t.checked)},changeQuickbuttonOpt:function(e,t){if(!this.allowedQuickbuttonOpts.includes(t.value))return!1;this.emit("toggle:quickbuttonopt-setting",t.name,t.value)},toggleNotes:function(e,t){this.emit("toggle:notification-setting",t.name,t.checked)},toggleMisc:function(e,t){this.emit("toggle:misc-setting",t.name,t.checked)},changeTmuiPositionOpt:function(e,t){this.emit("change:misc-setting",t.name,t.value),Array.from(this.el.getElementsByClassName("tmuipos")).forEach(function(e){return e.value=t.value})},changeCustomSearch:function(e,t){this.hideCustomSearchSettingSuccess();var n=document.getElementById("custom-search--start"),r=document.getElementById("custom-search--end"),o=n.value,i=r.value;o||i?this.emit("change:custom-search-setting",[o,i]):(n.value=this.customSearch,r.value="",this.emit("change:custom-search-setting",!1))},getRandomLightColor:function(){return"#"+Math.floor(16777215*(.8+.175*Math.random())).toString(16)}})};var r=n(0),o=s(n(12)),i=s(n(48));function s(e){return e&&e.__esModule?e:{default:e}}},5:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var n in t)e[n]||(e[n]=t[n]);return e}},50:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={by:{date:{created:function(e){return this._sort(e,"first")},last:function(e){return this._sort(e,"last")},_sort:function(e,t){return Object.keys(e).sort(function(n,r){return(n=new Date(e[n][t]))==(r=new Date(e[r][t]))?0:n<r?1:-1})}},name:{az:function(e){return this._sort(e)},za:function(e){return this._sort(e).reverse()},_sort:function(e){return Object.keys(e).sort(function(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())})}}}}},51:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e;return new r._DOMMODULE((a(e={el:document.getElementById("history"),events:{ENV:{"opened:tab":"init","updated:history":"render","failed:sync-entry":"undoSyncToggle","paginate:history":"paginate"},DOM:{click:{".action-button":"delegateButtonAction",".switch":"toggleSwitch",".name":"open",".view":"view","#search-toggle":"toggleSearch","#remove-filter":"removeFilter"},change:{".checkmark-all":"checkmarkAll","#sort-entries":"sort","#filter-entries":"filter","#entries-per-page":"changeCountPerPage","#set-view":"setView","#action":"onChangeAction"},keyup:{"#search-entries":"search"}}},initialized:!1,names:[],entries:{},entryTmpl:document.getElementById("entry-template"),entriesContainer:document.getElementById("entries"),page:1,perPage:10,sorted:"date-last",viewMode:"list",searchTerm:"",searched:[],tags:[],filtered:!1,filterOptionsSet:!1,init:function(e){"history"===e&&(this.initialized||this.render(),this.initialized=!0)}},"delete",function(e){window.confirm(browser.i18n.getMessage("del_confirm"))&&this.emit("delete:entries",e)}),a(e,"clean",function(e){this.emit("clean:entries",e)}),a(e,"download",function(e,t,n){var r=this;if("string"!=typeof t)return o.default.get("download_option").then(function(o){o=o.split(" "),t=o[0],n=2===o.length?o[1]:void 0,r.download(e,t,n)});this.getData(e,t,n).then(function(t){var n=encodeURIComponent(t),r=document.createElement("a");r.setAttribute("download","Textmarker ("+e.join("_")+").txt"),r.href="data:text/plain;charset=utf-8,"+n,document.body.appendChild(r),r.click(),document.body.removeChild(r)})}),a(e,"export",function(e){var t={history:{entries:{},order:[]}},n=t.history.entries,r=t.history.order,i=document.createElement("a");o.default.get("history").then(function(o){for(var s=void 0;e.length;)s=e.pop(),n[s]=o.entries[s],r.push(s);t=encodeURIComponent(JSON.stringify(t)),i.setAttribute("download","Textmarker-backup-"+(new Date).toLocaleString().replace(/\D/g,"_")+".json"),i.href="data:text/json;charset=utf-8,"+t,document.body.appendChild(i),i.click(),document.body.removeChild(i)})}),a(e,"sync",function(e,t){this.emit("sync:entry",e[0],t.classList.contains("active"))}),a(e,"visit",function(e){var t=this;this.getURLs(e).then(function(e){return t.emit("open:entries",e)})}),a(e,"open",function(e,t){this.emit("open:entries",t.getAttribute("data-url"))}),a(e,"view",function(e,t){this.emit("view:entry",t.getAttribute("data-name"))}),a(e,"tag",function(e,t){var n=this,r={sync:[],local:[]};e.forEach(function(e){n.origEntries[e].synced?r.sync.push(e):r.local.push(e)}),this.emit("tag:entries",r,t),this.addFilterOpt(t,t)}),a(e,"processSelection",function(){var e=document.querySelectorAll(".entry-cb:checked"),t=e.length;if(!t)return!1;for(var n=document.getElementById("action").value,r=[];t--;)r.push(e[t].getAttribute("data-name"));if("tag"===n){var o=document.getElementById("tag").value;this.tag(r,o)}else{var i=document.getElementById("specification").value.split(" "),s=i[0],a=i[1];!this[n]||this[n](r,s,a)}}),a(e,"renderEntries",function(){var e=this,t=this.entryTmpl,n=this.entriesContainer,r=this.entries,o=!!this.searchTerm,i=o?this.searched:this.names,s=o?i.length:this.page*this.perPage,a=o?0:s-this.perPage,c=void 0,u=void 0,l=void 0,d=void 0,g=void 0,h=void 0,f=void 0,m=void 0,p=void 0,y=void 0,v=void 0;if(this.filtered&&(i=i.filter(function(e){return!!r[e]})),s=Math.min(s,i.length),n.innerText="",document.getElementById("checkmark-all").checked=!1,!s)return this;for(;a<s;a++)!function(o,s){if(l=i[o],u=r[l]){for(p=u.tag||"",c=t.cloneNode(!0),n.appendChild(c),c.id="entry-"+s,c.classList.remove("none"),c.setAttribute("data-name",l),d=c.getElementsByClassName("name")[0],g=c.getElementsByTagName("input")[0],h=c.getElementsByTagName("label")[0],c.getElementsByClassName("details")[0],f=c.getElementsByClassName("quick-action"),m=c.getElementsByClassName("view")[0],y=c.getElementsByClassName("tag")[0],v=f.length;v--;)f[v].setAttribute("data-name",l);d.innerText=l,d.setAttribute("data-url",u.url),g.className="entry-cb",g.id="entry-cb-"+s,g.setAttribute("data-name",l),m.setAttribute("data-name",l),h.setAttribute("for","entry-cb-"+s),y.innerText=p||browser.i18n.getMessage("detail_notag"),c.getElementsByClassName("created")[0].innerText=e.optimizeDateString(new Date(u.first).toLocaleString()),c.getElementsByClassName("last")[0].innerText=e.optimizeDateString(new Date(u.last).toLocaleString()),c.getElementsByClassName("count")[0].innerText=u.marks.length,(void 0===u.synced||u.synced)&&c.getElementsByClassName("sync-switch")[0].classList.add("active")}}(a,s-a-1);return this}),a(e,"toggleHeaderFields",function(e){var t=this,n=document.getElementById("no-entries"),r=document.getElementById("search"),i=document.getElementById("history-actions"),s=document.getElementById("sort"),a=document.getElementById("filter"),c=document.getElementById("count"),u=document.getElementById("view"),l=document.getElementById("entries-per-page"),d=document.getElementById("checkmark-all-container"),g=e?"add":"remove",h=e>0?"remove":"add",f=e>2?"remove":"add",m=e>10?"remove":"add";return n.classList[g]("none"),i.classList[h]("none"),r.classList[f]("none"),s.classList[f]("none"),a.classList[f]("none"),c.classList[m]("none"),u.classList[h]("none"),d.classList[f]("none"),document.getElementById("entries-count").innerText=e,o.default.get("settings").then(function(e){var n=t.perPage=e.history.pp||10;l.value=n})}),a(e,"setFilterOptions",function(){var e=this;if(this.filterOptionsSet)return this;var t=[],n=this.origEntries,r=void 0;for(var o in n)(r=n[o].tag||null)&&!t.includes(r)&&t.push(r);t.length||document.getElementById("filter-opt-notag")?(t.forEach(function(t){return e.addFilterOpt(t,t)}),document.getElementById("filter-opt-tagless")||this.addFilterOpt("",browser.i18n.getMessage("t5125"),{id:"filter-opt-tagless"})):this.addFilterOpt("",browser.i18n.getMessage("detail_notag"),{disabled:!0,id:"filter-opt-notag"}),this.filterOptionsSet=!0}),a(e,"addFilterOpt",function(e,t,n){if(this.tags.includes(e))return this;var r=document.getElementById("filter-entries"),o=document.createElement("option");if(r.appendChild(o),o.value=e,o.innerText=t,n)for(var i in n)o.setAttribute(i,n[i]);if(!this.tags.length&&e){var s=document.getElementById("filter-opt-notag");s&&r.removeChild(s),document.getElementById("filter-opt-tagless")||this.addFilterOpt("",browser.i18n.getMessage("t5125"),{id:"filter-opt-tagless"})}e&&this.tags.push(e)}),a(e,"getText",function(e,t){var n=this,r="+meta"===t,i="+lost"===t,s="+notes"===t,a="lost"===t,c=["m","2","3",2,3],u=c.includes(t)?function(e){return e!=t}:"c"===t?function(e){return c.includes(e)}:null,l=browser.i18n.getMessage("note"),d="",g=e.length,h=0,f=void 0,m=void 0,p=void 0,y=void 0,v=void 0,_=void 0,b=void 0,E=void 0;return o.default.get("history").then(function(t){for(var o=t.entries;h<g;h++){if(v=e[h],f=o[v],m=f.marks,y=f.lost,_=m.length,b=y.length,!a)for((r||s)&&(d+=v+"\r\nURL: "+f.url+"\r\n"+browser.i18n.getMessage("page_title")+": "+f.title+"\r\n"+browser.i18n.getMessage("created")+": "+n.optimizeDateString(new Date(f.first).toLocaleString())+"\r\n"+browser.i18n.getMessage("last_modified")+": "+n.optimizeDateString(new Date(f.last).toLocaleString())+"\r\n\r\n\r\n"),E=0;E<_;E++)p=m[E],u&&u(p.key)||(s&&(d+="---\r\n"),d+=p.text.replace(/\n/g,"\r\n")+"\r\n\r\n",s&&p.note&&(d+="  "+l+":\r\n  "+p.note.replace(/\n/g,"\r\n  ")+"\r\n\r\n"));if(a||i)for(d+="\r\n\r\n"+browser.i18n.getMessage("lost_marks")+":\r\n\r\n\r\n\r\n",E=0;E<b;E++)p=y[E],d+=p.text.replace(/\n/g,"\r\n")+"\r\n\r\n";d+="\r\n\r\n\r\n\r\n\r\n\r\n"}return d.trim()})}),a(e,"getData",function(e,t,n){var r=this;return"text"===t?this.getText(e,n):o.default.get("history").then(function(n){for(var o=r.origEntries=n.entries,i=e.length,s="",a=0;a<i;a++)s+=o[e[a]][t]+"\r\n\r\n";return s})}),a(e,"getURLs",function(e){return o.default.get("history").then(function(t){for(var n=t.entries,r=[],o=e.length,i=0;i<o;i++)r.push(n[e[i]].url);return r})}),a(e,"optimizeDateString",function(e){return e.replace(/^(\d{1})(\D{1})/,function(e,t,n){return"0"+t+n}).replace(/(\D{1})(\d{1}\D{1})/g,function(e,t,n){return t+"0"+n})}),a(e,"search",function(e,t){var n=t.value.toLowerCase(),r=document.getElementById("count"),o=n?"add":"remove",i=document.getElementById("search-toggle");this.setupSearch(n).renderEntries(),r.classList[o]("none"),i.classList[o]("active")}),a(e,"setupSearch",function(e){e="string"==typeof e?e:this.searchTerm;var t=this.el,n=document.getElementById("search-count");if(this.searched=[],this.searchTerm=e,!e)return t.classList.remove("searched"),n.innerText="",this;t.classList.add("searched");for(var r=this.names,o=r.length,i=0,s=void 0;i<o;i++)-1!==(s=r[i]).toLowerCase().search(e)&&this.searched.push(s);return n.innerText=this.searched.length||"",this}),a(e,"toggleSearch",function(e,t){t.classList.contains("active")&&(document.getElementById("search-entries").value="",this.searchTerm&&this.search(null,{value:""}))}),a(e,"changeCountPerPage",function(e,t){var n=this.perPage=1*t.value;this.page=1,this.emit("changed:per-page-count",n),this.renderEntries()}),a(e,"setView",function(e,t){var n=document.getElementById("entries"),r=t.value;"list"===r?n.classList.remove("detailed-list"):n.classList.add("detailed-list"),this.emit("change:view-setting",r)}),a(e,"setupView",function(e){document.getElementById("set-view").value=e,this.setView(null,{value:e})}),a(e,"onChangeAction",function(e,t){"tag"===t.value&&setTimeout(function(){return document.getElementById("tag").focus()},0)}),a(e,"sort",function(e,t){var n=this.sorted=t.value;this.emit("change:sort-setting",n),this.setupSort(n).renderEntries()}),a(e,"setupSort",function(e){return e=e.split("-"),this.names=i.default.by[e[0]][e[1]](this.origEntries),this.sortSearchResults(),this}),a(e,"filter",function(e,t){var n=t.value,r=this.origEntries,o={},i=void 0,s=0;for(var a in t.parentNode.classList.add("active"),r)((i=r[a]).tag&&i.tag===n||!i.tag&&""==n)&&(o[a]=i,s++);this.entries=o,this.filtered=!0,this.page=1,this.renderEntries(),this.emit("filtered:history",s)}),a(e,"removeFilter",function(e,t){t.parentNode.classList.remove("active"),document.getElementById("filter-entries").selectedIndex=0,this.entries=this.origEntries,this.filtered=!1,this.page=1,this.renderEntries(),this.emit("filtered:history",this.names.length)}),a(e,"sortSearchResults",function(){if(this.searched.length){var e=this.names;this.searched.sort(function(t,n){return(t=e.indexOf(t))==(n=e.indexOf(n))?0:t<n?-1:1})}}),a(e,"checkmarkAll",function(e,t){for(var n="boolean"==typeof t?t:t.checked,r=document.getElementById("entries").getElementsByTagName("input"),o=r.length;o--;)r[o].checked=n;return!1}),a(e,"delegateButtonAction",function(e,t){var n=t.getAttribute("data-action"),r=t.getAttribute("data-name");r=r?[r]:void 0,!this[n]||this[n](r,t)}),a(e,"toggleSwitch",function(e,t){(t=t.classList.contains("sync-switch")?t:t.parentNode).classList.toggle("active"),this.delegateButtonAction(e,t)}),a(e,"undoSyncToggle",function(e){document.querySelector('.sync-switch[data-name="'+e+'"]').classList.toggle("active")}),a(e,"render",function(){var e=this;o.default.get().then(function(t){e.entries=e.origEntries=t.history.entries;var n,r=t.settings.history.sorted||e.sorted,o=t.settings.history.view||e.viewMode;e.sorted=r,e.setupSort(r),e.setupView(o),n=e.names.length,e.setupSearch().toggleHeaderFields(n).then(function(){return e.renderEntries().setFilterOptions()})})}),a(e,"paginate",function(e){this.page=e,this.renderEntries()}),a(e,"updateEntry",function(e){var t=document.querySelector('.entry[data-name="'+e.name+'"]');t.getElementsByClassName("created")[0].innerText=e.first,t.getElementsByClassName("last")[0].innerText=e.last,t.getElementsByClassName("count")[0].innerText=e.marks.length}),e))};var r=n(0),o=s(n(12)),i=(s(n(14)),s(n(50)));function s(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},52:function(e,t,n){"use strict";var r=h(n(12)),o=n(0),i=h(n(51)),s=h(n(49)),a=h(n(47)),c=h(n(46)),u=h(n(45)),l=h(n(44)),d=h(n(43)),g=h(n(18));function h(e){return e&&e.__esModule?e:{default:e}}new o._MODULE({events:{ENV:{"started:app":"start","updated:settings":"start","updated:history":"start"}},allowedHashes:["news","manual","settings","history","contact","sync","export","logs"],bootstrapped:!1,autoinit:function(){var e=this;r.default.get().then(function(t){t.settings&&t.history&&e.start()})},start:function(){this.bootstrapped||(this.bootstrapped=!0,(0,i.default)(),(0,s.default)(),(0,a.default)(),(0,c.default)(),(0,u.default)(),(0,l.default)(),(0,d.default)(),this.initMainNav())},initMainNav:function(){var e=window.location.hash.split("=")[1];this.allowedHashes.includes(e)&&window.document.getElementById("mainnav-"+e).classList.add("active"),new g.default(window.document.getElementById("mainnav"))}})},53:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=new r._PORT({name:"addon-page",type:"content",events:{ONEOFF:["change:style-setting","toggle:shortcut-setting","change:shortcut-setting","toggle:ctm-setting","change:saveopt-setting","toggle:priv-setting","change:namingopt-setting","change:sort-setting","change:view-setting","toggle:noteopt-setting","toggle:quickbuttonopt-setting","toggle:notification-setting","toggle:misc-setting","change:misc-setting","add:custom-marker","remove:custom-marker","delete:entries","clean:entries","open:entries","view:entry","sync:entry","sync:history","sync:settings","import:storage","toggle:sync","change:custom-search-setting","changed:per-page-count","error:browser-console","clear:logs","tag:entries"]}})},54:function(e,t,n){"use strict";n(111);var r=n(0),o=(s(r),s(n(18))),i=s(n(14));function s(e){return e&&e.__esModule?e:{default:e}}n(53),n(12),n(52),(0,r._L10N)(),document.getElementById("version-number").innerText=browser.runtime.getManifest().version;for(var a=document.getElementsByClassName("subnav"),c=a.length;c--;)new o.default(a[c]);for(var u=document.getElementsByClassName("toggle-button"),l=u.length;l--;)new i.default(u[l])},6:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t._COPY=function e(t,n){for(var o in n=n||{},t)t.hasOwnProperty(o)&&("object"===r(t[o])?(n[o]=Array.isArray(t[o])?[]:{},e(t[o],n[o])):n[o]=t[o]);return n}},9:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){document.addEventListener("DOMContentLoaded",function(){
/*
* Translates a HTMl page in the web l10n style from the Add-on SDK with WebExtensions strings.
* Modified by underflyingbirches
*
* @author Martin Giger
* @see {@link https://gist.github.com/freaktechnik/4a72bc0711d9bc82cf3b075bcc292953}
* @license MPL-2.0
*/
return function(){var e=void 0,t=void 0,n=void 0;document.documentElement.setAttribute("lang",browser.i18n.getUILanguage().replace("_","-"));var r=document.querySelectorAll("*[data-l10n-id]"),o=document.querySelectorAll("*[data-l10n-attr]"),i=!0,s=!1,a=void 0;try{for(var c,u=r[Symbol.iterator]();!(i=(c=u.next()).done);i=!0){e=c.value;var l=(n=e.dataset).l10nId;l&&(t=browser.i18n.getMessage(l))&&"??"!=t&&(e.textContent=t)}}catch(e){s=!0,a=e}finally{try{!i&&u.return&&u.return()}finally{if(s)throw a}}var d=!0,g=!1,h=void 0;try{for(var f,m=o[Symbol.iterator]();!(d=(f=m.next()).done);d=!0)e=f.value,n=e.dataset,["Title","Placeholder"].forEach(function(r){var o=n["l10n"+r];o&&(t=browser.i18n.getMessage(o))&&"??"!=t&&e.setAttribute(r.toLowerCase(),t)})}catch(e){g=!0,h=e}finally{try{!d&&m.return&&m.return()}finally{if(g)throw h}}}()},{capture:!1,passive:!0,once:!0})}}});